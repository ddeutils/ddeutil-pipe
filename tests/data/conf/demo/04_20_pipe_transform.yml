pipe_sql_ingest:
  type: pipeline.Pipeline
  version: '1'
  desc: "Pipeline that load data from RDBMS"
  params:
    run_date: utils.receive.datetime
    connection: utils.selection.conn
    procedure: utils.receive.string
  jobs:
    transform:
      stages:
        - name: Transform Data on Target RDBMS
          hook: hooks/postgres-proc@pysycopg
          with:
            conn: ${{ params.connection }}
            exec: ${{ params.procedure }}
            params:
              source: ${{ params.source }}
              target: ${{ params.target }}
              run_date: ${{ params.run_date }}
